---
title: Gene_dungeonplus
description: Gene_dungeonplus 插件文档
keywords: ["navigation", "sidebar", "menus", "mdx", "nextjs", "documents"]
---

# Gene_dungeonplus 插件文档

## 概述

Gene_dungeonplus 是基于 DungeonPlus 插件的扩展插件，为副本系统提供增强功能。主要功能包括：

- 🔧 **附属扩展脚本** - 提供多种副本交互脚本
- 📊 **PlaceholderAPI 变量** - 支持动态数据显示
- 🛠️ **配置工具命令** - 辅助配置坐标信息

## 附属扩展脚本

插件提供了四个内置的副本扩展脚本，用于增强副本的交互功能。

### 1. `apscript` - 持续AP属性脚本

**功能描述：**
为玩家添加持续时间的 AttributePlus 属性效果。

**脚本标识：** `apscript`

**触发类型：** `TRIGGER_SELF`

**参数说明：**
- `keeptime`: 属性持续时间（单位：游戏刻，20刻=1秒）
- `attkey`: AttributePlus 属性键（如："血量+500"）

**使用示例：**
```yaml
# 持续100游戏刻（5秒）的血量+500效果
$apscript{keeptime=100;attkey=血量+500} @player
```

**使用场景：**
- 副本内临时属性加成
- 机关触发时的属性增强
- 特殊区域的属性效果

---

### 2. `settlement` - 翻牌结算脚本

**功能描述：**
触发翻牌结算界面，调用 Gene_Settlement 插件进行战利品分配。

**脚本标识：** `settlement`

**触发类型：** `TRIGGER_SELF`

**参数说明：**
- `dungeonKey`: 地牢标识符（对应 Settlement 配置中的 dungeonKey）
- `time`: 延迟时间（单位：秒）
- `difficulty`: 难度等级（如：easy, normal, hard）
- `loot_number`: 抽取战利品数量

**使用示例：**
```yaml
# 60秒后开始翻牌，抽取3个hard难度物品
$settlement{dungeonKey=死亡矿井;time=60;difficulty=hard;loot_number=3} @player
```

**功能流程：**
1. 收集当前副本队伍中所有玩家的信息
2. 延迟指定时间后调用 SettlementApi
3. 打开翻牌结算界面供玩家选择战利品

---

### 3. `dpspawn` - 重设个人出生点脚本

**功能描述：**
为触发玩家设置新的重生点位置。

**脚本标识：** `dpspawn`

**触发类型：** `TRIGGER_SELF`

**参数说明：**
- `point`: 重生点名称（对应配置中的点位名称）

**使用示例：**
```yaml
# 设置玩家的重生点为"检查点1"
$dpspawn{point=检查点1} @self
```

**执行逻辑：**
1. 检查玩家数据是否存在
2. 验证重生点名称是否为空或已设置
3. 从副本模板配置中获取对应位置
4. 更新玩家的重生点数据

---

### 4. `setteamspawn` - 重设全队出生点脚本

**功能描述：**
为整个队伍的所有玩家设置新的重生点位置。

**脚本标识：** `setteamspawn`

**触发类型：** `TRIGGER_SELF`

**参数说明：**
- `point`: 重生点名称（对应配置中的点位名称）

**使用示例：**
```yaml
# 设置全队的重生点为"安全区"
$setteamspawn{point=安全区} @self
```

**执行逻辑：**
1. 遍历所有玩家数据
2. 跳过不需要更新的情况（空名称或已匹配）
3. 从副本模板获取对应组的重生点配置
4. 批量更新所有玩家的重生点

## PlaceholderAPI 变量

插件注册了 PlaceholderAPI 扩展，提供副本相关的数据变量。

### 扩展标识符

**前缀：** `GeneDplus`

### 可用变量

#### `%GeneDplus_GroupName%`
- **描述：** 获取玩家当前所在的分组名称
- **返回值：** 字符串（分组名）
- **示例：** `精英组`

#### `%GeneDplus_CurrentRePointName%`
- **描述：** 获取玩家当前的重生点名称
- **返回值：** 字符串（重生点名）
- **示例：** `检查点1`

### 使用说明

- 如果玩家数据不存在，返回空字符串 `""`
- 可在任何支持 PAPI 的插件中使用（如：计分板、聊天格式等）

**使用示例：**
```yaml
# 在计分板显示玩家分组和重生点
scoreboard:
  title: "副本信息"
  lines:
    - "分组: %GeneDplus_GroupName%"
    - "重生点: %GeneDplus_CurrentRePointName%"
```

## 命令系统

### `/Dplus l` - 坐标输出命令

**功能描述：**
输出玩家当前位置的坐标信息，主要用于填写配置文件中的机器坐标。

**权限要求：** `dplus.command`

**命令格式：**
```bash
/Dplus l
```

**功能说明：**
- 仅玩家可用（控制台无效）
- 输出格式化的位置字符串
- 包含世界、X、Y、Z坐标信息
- 支持小数点精度

**输出示例：**
```
world:10.5,64.0,-25.3
```

**使用场景：**
- 配置副本机关坐标
- 设置重生点位置
- 记录关键位置信息

### `/Dplus reload` - 重载配置

**功能描述：**
重新加载副本模板配置。

**权限要求：** `dplus.command`

**命令格式：**
```bash
/Dplus reload
```

**执行结果：**
```
[dplus]reload successful.
```

## 插件工作日志

| 提交时间                              | 提交内容                                                                          |
|--------------------------------------|---------------------------------------------------------------------------------|
| **2025-12-26 16:33:00 +0800** | [feat]更新dp的版本信息以及scirpt调用 |
| **2025-12-26 16:32:56 +0800** | [feat]更新dp的版本信息以及scirpt调用 |
| **2025-12-25 22:40:57 +0800** | [fix]修复playerNameToUuidMap逻辑map为空 |
| **2025-12-25 10:22:49 +0800** | [feat]移除版本号逻辑 |
| **2025-12-25 10:22:05 +0800** | [feat]新增玩家退出副本逻辑 |
| **2025-12-23 20:38:38 +0800** | [feat]新增副本翻牌逻辑处理 |
| **2025-10-29 12:16:24 +0800** | [feat]修改加载规则中文异常问题 |
| **2025-10-20 21:37:03 +0800** | [feat]修改副本Dplus中机关的实体触碰宽高 |
| **2025-10-16 11:28:43 +0800** | [feat]修改副本复活次数上限 |
| **2025-10-05 00:33:53 +0800** | [feat]更新dp默认配置项英文 |
| **2025-09-28 00:41:14 +0800** | [feat]升级为6.2.3 |
| **2024-11-20 00:44:23 +0800** | [fat]修正强依赖项改为弱依赖项 |
| **2024-11-20 00:31:52 +0800** | [fat]升级版本号1.0.1 |
| **2024-11-10 17:45:07 +0800** | [fat]升级版本号1.0.1 |
| **2024-11-10 17:15:10 +0800** | [fat]增加Dplus获取副本人数信息Api |
| **2024-06-10 23:06:15 +0800** | 修正脚本执行发昂视 |
| **2024-03-22 15:26:48 +0800** | 初始化迁移提交 |
| **2024-03-22 14:35:49 +0800** | Initial Commit |

---
**插件工作日志**


